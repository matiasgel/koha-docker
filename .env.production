# =============================================================================
# CONFIGURACIÓN DE PRODUCCIÓN KOHA DOCKER LINUX  
# =============================================================================
# Archivo de variables de entorno para producción Linux.
# Copiar como .env y personalizar según el entorno.
#
# IMPORTANTE: Cambiar todas las contraseñas antes de usar en producción
# =============================================================================

# === CONFIGURACIÓN DE BASE DE DATOS ===
KOHA_DB_NAME=koha_production
KOHA_DB_USER=koha_admin
KOHA_DB_PASSWORD=KohaDB#2024$Secure789
MYSQL_ROOT_PASSWORD=RootDB#2024$Strong456
MARIADB_ROOT_PASSWORD=RootDB#2024$Strong456

# MySQL/MariaDB Server
MYSQL_SERVER=db
DB_NAME=${KOHA_DB_NAME}
MYSQL_USER=${KOHA_DB_USER}
MYSQL_PASSWORD=${KOHA_DB_PASSWORD}

# === CONFIGURACIÓN DE DOMINIO Y RED ===
# IMPORTANTE: Configurar para acceso desde toda la red
# Opciones:
#   0.0.0.0          → Escucha en todos los interfaces (RECOMENDADO)
#   localhost        → Solo acceso local
#   IP específica    → 192.168.1.100 o similar
#   Dominio          → biblioteca.ejemplo.com
KOHA_DOMAIN=0.0.0.0
OPAC_DOMAIN=0.0.0.0
KOHA_INSTANCE=production

# Configuración de puertos
KOHA_INTRANET_PORT=8081
KOHA_OPAC_PORT=8080
KOHA_INTRANET_PREFIX=
KOHA_INTRANET_SUFFIX=
KOHA_OPAC_PREFIX=
KOHA_OPAC_SUFFIX=

# === CONFIGURACIÓN DE SERVICIOS ===
# Memcached
MEMCACHED_SERVERS=memcached:11211

# RabbitMQ (Message Broker)
MB_HOST=rabbitmq
MB_PORT=61613
MB_USER=koha
MB_PASS=RabbitMQ#2024$Queue123
RABBITMQ_PASSWORD=${MB_PASS}
RABBITMQ_USER=${MB_USER}

# === CONFIGURACIÓN DE IDIOMAS ===
# Idiomas a instalar (separados por espacios)
# Disponibles: es-ES, en-GB, fr-FR, de-DE, it-IT, pt-BR, etc.
KOHA_LANGS="es-ES en-GB"

# === CONFIGURACIÓN DE BÚSQUEDA ===
# Zebra (por defecto) o Elasticsearch
ZEBRA_MARC_FORMAT=marc21
ZEBRA_LANGUAGE=es

# Para usar Elasticsearch (opcional)
# USE_ELASTICSEARCH=true
# ELASTICSEARCH_HOST=elasticsearch:9200
# OVERRIDE_SYSPREF_SearchEngine=Elasticsearch

# === CONFIGURACIÓN DEL SISTEMA ===
# Rutas del sistema Linux
INSTALL_DIR=/opt/koha-docker
DATA_DIR=/opt/koha-docker/data
DATA_PATH=/opt/koha-docker/data
BACKUP_DIR=/opt/koha-docker/backups
LOG_DIR=/var/log/koha-docker

# Zona horaria
TIMEZONE=America/Argentina/Buenos_Aires
TZ=${TIMEZONE}

# === CONFIGURACIÓN DE APLICACIÓN ===
# Versión de Koha
KOHA_VERSION=24.11

# Configuración de Plack
KOHA_PLACK_NAME=koha
KOHA_PLACK_WORKERS=2

# === CREDENCIALES INICIALES DE KOHA ===
# Estas credenciales se usan para el primer acceso web
KOHA_ADMIN_USER=koha_admin
KOHA_ADMIN_PASSWORD=KohaAdmin#2024$Web456
KOHA_LIBRARY_NAME="Biblioteca Principal"

# === CONFIGURACIÓN SSL ===
SSL_ENABLED=true
SSL_CERT_PATH=/opt/koha-docker/ssl/cert.pem
SSL_KEY_PATH=/opt/koha-docker/ssl/key.pem

# === CONFIGURACIÓN DE BACKUP ===
# Retención de backups en días
BACKUP_RETENTION_DAYS=30
# Programación de backup (formato cron)
BACKUP_SCHEDULE="0 2 * * *"
# Directorio de backup
BACKUP_PATH=${BACKUP_DIR}

# === CONFIGURACIÓN DE LOGS ===
LOG_LEVEL=INFO
LOG_TO_SYSLOG=false

# Rotación de logs de Apache
APACHE_LOG_LEVEL=warn
APACHE_ACCESS_LOG=${LOG_DIR}/apache/access.log
APACHE_ERROR_LOG=${LOG_DIR}/apache/error.log

# === CONFIGURACIÓN DE RENDIMIENTO ===
# Configuración de memoria para contenedores (opcional)
# KOHA_MEMORY_LIMIT=2g
# DB_MEMORY_LIMIT=2g
# RABBITMQ_MEMORY_LIMIT=512m

# Número de workers para procesos background
KOHA_BACKGROUND_WORKERS=4

# === CONFIGURACIÓN DE SEGURIDAD ===
# Restricción de acceso por IP (opcional)
# ALLOWED_IPS=127.0.0.1,10.0.0.0/8,192.168.0.0/16

# Configuración de sesiones
SESSION_TIMEOUT=7200
COOKIE_SECURE=false

# === CONFIGURACIÓN DE EMAIL (OPCIONAL) ===
# Para notificaciones por email
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_USER=biblioteca@ejemplo.com
# SMTP_PASSWORD=password_email
# SMTP_TLS=true

# === CONFIGURACIÓN DE MONITOREO ===
MONITORING_ENABLED=true
HEALTH_CHECK_INTERVAL=30

# === CONFIGURACIÓN AVANZADA ===
# Configuración de límites de recursos Docker
# CPU_LIMIT=2
# MEMORY_LIMIT=4g

# Red Docker personalizada
DOCKER_NETWORK=koha-network
NETWORK_SUBNET=172.20.0.0/16

# === CONFIGURACIÓN DE DESARROLLO (NO USAR EN PRODUCCIÓN) ===
# Descomenta solo para desarrollo/debug
# DEBUG=false
# KOHA_DEBUG=0
# MYSQL_DEBUG=0

# === NOTAS DE CONFIGURACIÓN ===
# 1. Cambiar TODAS las contraseñas que contienen "CAMBIAR_PASSWORD"
# 2. Configurar KOHA_DOMAIN con el dominio real del servidor
# 3. Ajustar TIMEZONE según la ubicación geográfica
# 4. Personalizar KOHA_LIBRARY_NAME con el nombre de tu biblioteca
# 5. Para producción, configurar SSL con certificados válidos
# 6. Configurar SMTP para notificaciones por email
# 7. Ajustar límites de memoria según hardware disponible

# === VARIABLES CALCULADAS AUTOMÁTICAMENTE ===
# Estas variables se calculan en base a las anteriores
KOHA_CONF_DIR=${DATA_DIR}/koha/etc
KOHA_VAR_DIR=${DATA_DIR}/koha/var
KOHA_LOG_DIR=${DATA_DIR}/koha/logs

# Variables adicionales para compatibilidad
MARIADB_ROOT_PASSWORD=${MYSQL_ROOT_PASSWORD}
DATA_PATH=${DATA_DIR}